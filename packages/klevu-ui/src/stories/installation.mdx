import { Meta } from "@storybook/addon-docs"

<Meta title="Guides/Installation" />

**Table of Contents**

- [NPM packages](#installing-with-npm-packages)
  - [@klevu/ui](#klevuui)
  - [@klevu/ui-react](#klevuui-react)
  - [@klevu/ui-vue](#klevuui-vue)
- [VanillaJS with build files](#installing-with-build-vanillajs)
- [VanillaJS through CDN](#installing-with-cdn-url-vanillajs)
- [Klevu-init](#klevuinit-component)

# Installing with NPM packages

Currently components can be used either with vanilla JS (`@klevu/ui`), React (`@klevu/ui-react`) or Vue (`@klevu/ui-vue`).
Each of them have slightly different initialization.

## @klevu/ui

Standard Components package that you can use with any framework. Just import JS and CSS file and start using these components.

At development phase we currently support only module way of loading UI library through NPM.

To use library in Vanilla JS project you need to first install package `@klevu/ui`

```bash
npm install @klevu/ui
```

Then in your html file (index.html) add following script tag to your `head` tag.

```html
<script type="module" src="./node_modules/@klevu/ui/dist/klevu-ui/klevu-ui.esm.js"></script>
```

And add CSS variables templates to your `head` tag too. These can be replace with your own values if you wish.

```html
<link rel="stylesheet" href="./node_modules/@klevu/ui/dist/klevu-ui/klevu-ui.css" />
```

Now you are free to try it out. Just replace API key and URL to ones found from your Klevu Merchant Center settings page.

```html
<klevu-init
  api-key="klevu-165829460115715456"
  url="https://eucs30v2.ksearchnet.com/cs/v2/search"
  assets-path="https://resources-webcomponents.klevu.com/latest/klevu-ui"
>
  <klevu-quicksearch></klevu-quicksearch>
</klevu-init>
```

## @klevu/ui-react

Components automatically compiled into React components. These components can be used with React framework in native and easy
way. Can be easily placed inside React components.

In your React application add `@klevu/ui-react` package.

```bash
npm install @klevu/ui-react
```

And add CSS variables templates to your `head` tag. These can be replace with your own values if you wish.

```html
<link rel="stylesheet" href="./node_modules/@klevu/ui/dist/klevu-ui/klevu-ui.css" />
```

Now you can use React components from package. First wrap everything with `KlevuInit` component and then use other components.

```ts
import React from "react"
import { KlevuInit, KlevuQuickSearch } from "@klevu/ui-react"

export function SimpleKlevuApp() {
  return (
    <KlevuInit apiKey="klevu-165829460115715456" url="https://eucs29v2.ksearchnet.com/cs/v2/search">
      <KlevuQuickSearch />
    </KlevuInit>
  )
}
```

As you can see syntax is almost same as in default Components version. Only kebab-case has been changed to CamelCase.

## @klevu/ui-vue

Components automatically compiled into Vue components. Use Vue syntax to embed components into your code.

In your Vue application add `@klevu/ui-vue` package.

```bash
npm install @klevu/ui-vue
```

And add CSS variables templates to your `head` tag. These can be replace with your own values if you wish.

```html
<link rel="stylesheet" href="./node_modules/@klevu/ui/dist/klevu-ui/klevu-ui.css" />
```

Add KlevuComponents with `use()` when mounting app.

```ts
import { createApp } from "vue"
import App from "./App.vue"
import { KlevuComponents } from "@klevu/ui-vue"

createApp(App).use(KlevuComponents).mount("#app")
```

Then just use the components in your components:

```html
<template>
  <klevu-init
    url="https://eucs29v2.ksearchnet.com/cs/v2/search"
    api-key="klevu-164651914788114877"
    :settings.prop="{
      onItemClick(product: any, event: any) {
        console.log("clicked", product)
        return false;
      },
    }"
  >
    <klevu-quicksearch></klevu-quicksearch>
  </klevu-init>
</template>
```

Optional: To get code autocomplete in VSCode you can import the Klevu components to your component.

```html
<script setup lang="ts">
  import { KlevuInit, KlevuQuickSearch } from "@klevu/ui-vue"
</script>

<script lang="ts">
  export default {
    components: {
      KlevuInit,
      KlevuQuickSearch,
    },
  }
</script>
```

# Installing with build (VanillaJS)

You can get the particular version build from the [Releases](?path=/docs/guides-releases--docs) section of this documentation.

Please download the zip file for the release and extract the file into a folder and
specify the paths to the files as mentioned in the example below.

Basic example with HTML file:

```html
<!DOCTYPE html>
<html>
  <head>
    <title>Klevu UI Build example</title>
    <meta charset="UTF-8" />
    <script type="module" src="{EXTRACTED_FOLDER}/package/dist/klevu-ui/klevu-ui.esm.js"></script>
    <link href="{EXTRACTED_FOLDER}/package/dist/klevu-ui/klevu-ui.css" rel="stylesheet" />
  </head>

  <body>
    <klevu-init api-key="{API_KEY}" url="{STORE_URL}">
      <klevu-quicksearch></klevu-quicksearch>
    </klevu-init>
  </body>
</html>
```

# Installing with CDN url (VanillaJS)

Another way to get started is to use our CDN to get sources and import in the `head`
of the document.

NOTE: This way of integrating is **not recommended** for production use. It is best for testing the library.

Best way to integrate is to use NPM installation and building the library to be part of your application.

```html
<script type="module" src="https://resources-webcomponents.klevu.com/latest/klevu-ui/klevu-ui.esm.js"></script>
```

And it's important to embed CSS styles too:

```html
<link href="https://resources-webcomponents.klevu.com/latest/klevu-ui/klevu-ui.css" rel="stylesheet" />
```

**Warning:** These links will always load latest version of the library. Breaking changes will break your site.
To lock the version one should use versioned URL's by adding version number by replacing `latest` with version number.
For example `...klevu.com/0.6.0/klevu-ui/...`

Full example with HTML file:

```html
<!DOCTYPE html>
<html>
  <head>
    <title>Klevu UI CDN example</title>
    <meta charset="UTF-8" />
    <script type="module" src="https://resources-webcomponents.klevu.com/latest/klevu-ui/klevu-ui.esm.js"></script>
    <link href="https://resources-webcomponents.klevu.com/latest/klevu-ui/klevu-ui.css" rel="stylesheet" />
  </head>

  <body>
    <klevu-init api-key="klevu-165829460115715456" url="https://eucs30v2.ksearchnet.com/cs/v2/search">
      <klevu-quicksearch></klevu-quicksearch>
    </klevu-init>
  </body>
</html>
```

# KlevuInit component

KlevuInit is an essential component that needs to be added to your page. It is used to initialize Klevu UI for
full functionality.

## VanillaJS initialization

For simple initialization of Klevu components place following code in your HTML file right after `<body>` tag.

```html
<klevu-init api-key="klevu-165829460115715456" url="https://eucs30v2.ksearchnet.com/cs/v2/search"></klevu-init>
<script>
  document.querySelector("klevu-init").settings = {
    onItemClick: (product, event) => {
      // if you wish to prevent default url redirection you can use event.preventDefault() and redirect to your own url
    },
    generateProductUrl: (product) => {
      return `myurl.com/${product.id}`
    },
    renderPrice: (amount, currency) => `${amount} ${currency}`,
  }
</script>
```

## React initialization

For React initialization of Klevu components place following code in your React main file.

```jsx
import React from "react"
import { KlevuInit } from "@klevu/ui-react"
import { MyComponent } from "./my-component"

export function App() {
  return (
    <React.Fragment>
      <KlevuInit
        apiKey="klevu-165829460115715456"
        url="https://eucs30v2.ksearchnet.com/cs/v2/search"
        settings={{
          onItemClick: (product, event) => {
            // here you could use react router to do the redirection
          },
          generateProductUrl: (product) => {
            return `myurl.com/${product.id}`
          },
          renderPrice: (amount, currency) => `${amount} ${currency}`,
        }}
      />
      <MyComponent />
    </React.Fragment>
  )
}
```

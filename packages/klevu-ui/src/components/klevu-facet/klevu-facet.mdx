import { FilterManager, KlevuFilterType } from "@klevu/core"
import { ArgsTable, Canvas, Meta, Story, Description, Source } from "@storybook/addon-docs"
import { html, Fragment } from "lit-html"
import { ifDefined } from "lit-html/directives/if-defined.js"
import { MDXAutoFillMeta, fullMockRequest } from "../../storybookUtils"
const meta = MDXAutoFillMeta("klevu-facet")
const manager = new FilterManager()
manager.initFromListFilters(fullMockRequest.queryResults?.[0].filters)

<Meta title="Components/Facet" component="klevu-facet" argTypes={meta.argTypes} parameters={meta.parameters} />

# Klevu-facet

<Description>{meta.description}</Description>

<Canvas>
  <Story
    name="Facet"
    args={{
      manager: manager,
      option: manager.options[0],
      mode: "checkbox",
    }}
  >
    {(args) =>
      html`<klevu-facet
        accordion=${ifDefined(args.accordion)}
        accordion-start-open=${ifDefined(args.accordionStartOpen)}
        .customOrder=${args.customOrder}
        .manager=${args.manager}
        mode=${ifDefined(args.mode)}
        .option=${args.option}
        .slider=${args.slider}
      ></klevu-facet>`
    }
  </Story>
</Canvas>

As component includes only required properties it is easier to use component with @klevu/ui-react or other frameworks.

```jsx
import React from "react"
import { KlevuFacet } from "@klevu/ui-react"
import { FilterManager } from "@klevu/core"

const manager = new FilterManager()

// Load the manager options with KlevuFetch or other method.

const MyComp = () => {
  return <KlevuFacet manager={manager} option={manager.options[0]} mode="checkbox" />
}
```

<ArgsTable story="Facet" />

# Variations

It is possible to change all keys to be radio buttons instead of checkboxes by setting the mode to radio.

<Canvas>
  <Story
    name="Facet with radio"
    args={{
      manager: manager,
      option: manager.options[0],
      mode: "radio",
    }}
  >
    {(args) =>
      html`<klevu-facet
        accordion=${ifDefined(args.accordion)}
        accordion-start-open=${ifDefined(args.accordionStartOpen)}
        .customOrder=${args.customOrder}
        .manager=${args.manager}
        mode=${ifDefined(args.mode)}
        .option=${args.option}
        .slider=${args.slider}
      ></klevu-facet>`
    }
  </Story>
</Canvas>

By default all options in facet are in order of most common to least common. This can be changed by setting the customOrder property to an array of option keys in the order you want them to appear.

Here is how to do this with @klevu/ui-react. Green and petrol will be at the top. Rest are in order of most common to least common.

<Canvas withSource="none">
  <Story
    name="Custom order"
    args={{
      manager: manager,
      option: manager.options[0],
      customOrder: ["green", "petrol"],
    }}
  >
    {(args) =>
      html`<klevu-facet .customOrder=${args.customOrder} .manager=${args.manager} .option=${args.option}></klevu-facet>`
    }
  </Story>
</Canvas>

```jsx
<KlevuFacet manager={manager} option={manager.options[0]} customOrder={["green", "petrol"]} />
```

# Slider

Facet can also be used to display a slider. This is useful for price or other numeric filters.

<Canvas withSource="none">
  <Story
    name="Slider"
    args={{
      manager: manager,
      slider: manager.sliders[0],
    }}
  >
    {(args) =>
      html`<klevu-facet .customOrder=${args.customOrder} .manager=${args.manager} .slider=${args.slider}></klevu-facet>`
    }
  </Story>
</Canvas>
